
WEB6 Multi User on Passport - 7. 접근제어 글쓰기

오류:
Error: ENOENT: no such file or directory, open 'C:\Users\HBYU\Desktop\express\data\tfiqb4-DjeHAeWTw78kNU'
이유:
( response.redirect(`/topic/${id}`); 로 리다이렉트 되는데, id 값에 대한 파일이 없으니까 에러가 뜸 .



WEB6 Multi User on Passport - 8. 글목록 lowdb로 전환
- 실제 현실에서는 몇 개의 데이터를 가져올지 지정해야 함. 
예)  var filelist = db.get('topics').take(100).value(); 
- 이렇게 제한을 해야함. 아니면 데이터 베이스가 끝장남. 

WEB6 Multi User on Passport - 11. 비밀번호 저장
- bcrypt
- 이 알고리즘을 사용하면 비밀번호를 아주 안전하게 저장할 수 있다. 사용자가 ‘1’이 6개인 비밀번호를 저장한다. bcrypt 이용하여 비밀번호 처리하면 무작위의 문자가 나온다.
- 실제 비밀번호를 가진 사용자가 ‘1’ 6개를 입력하여 로그인 시도하면 그 때도 bcrypt 를 통과시키는 것이다. bcrypt가 가지고 있는 검증 알고리즘을 통해서 만들어진 값과, 저장된 값을 비교했을 때, 그 2개가 같다면, 원래 값이 무엇인지 몰라도, 우리는 이 사람이 저 비밀번호를 가지고 있었던 사람이라는 것을 알수가 있다. ( 이 메카니즘 특징) 
=> 관리자도 알 수 없는 비밀번호를 저장할 수 있고, 동시에 로그인을 통해 들어온 비밀번호와 비교할 수 있다. 보안강화 가능


- bcrypt npm으로 구글에 검색 ,  bcrypt 라이브러리 사용할 때(라이브러리 사용시 많은 사람들이 사용하는지도 중요하다). 
- 이런식으로 비번을 저장하게 되면 설령, db.json 의 패스워드가 공격자에게 그대로 노출된다고 해도 공격자 입장에서는 저 패스워드를 복원하는 것이 굉장히 까다롭고 비싼일이 되기 때문에 공격의 의지를 꺽어버리는 동기를 없애버리는 아주 중요한 효과가 있는 일이다. 

- 관심을 가질만한 주제
- 사용자가 입력한 정보를 신뢰해서는 안된다. 이메일, 비번 들의 유효성을 반드시 체크해야 한다. => validation 을 통해 유효성을 체크하는 여러 가지 방법을 찾을 수 있다. => 웹개발을 하는데 있어서 가장 지치는 일이 유효성 체크라고 해도 과언이 아니다. => 그만큼 중요하다. (2가지 방법: 웹브라우저 자바스크립트등을 이용해서 처리하는 것이고요, 다른 하나는 서버쪽에서 처리하는 것이다. 근본적인것은 서버쪽으로 들어오는 데이터를 처리하는 것이고, 브라우저에서 처리하는 것은 사용자의 편의성을 높여준다.)
- 사용자의 비번은 관리자도 원천적으로 볼수 없도록 암호화 해야 한다.이를 위해 salt, hash, key stretching 과 같은 기법들이 사용이 됨.  => bcrypt, scrypt 와 같은 기능을 사용해야함. 이러한 수단없이 사용자의 비번을 전달 받는것은 절대 절대 하면 안됨. => 비밀번호에 대한 원리를 찾아보세요. 흥미진진합니다. 
- 이멜을 통해 인증을 구현하고 있다.근데 사용자가 그 이멜의 주인이 맞을까? 이것을 체크하기 위해, 이멜 인증을 하기 전에사용자의 기능을 제한할 필요가 있다. 랜덤한 비밀 문자를 만들어 이멜 통해 전송했다가, 그 비번을 사용자가 시스템에 입력하면 그때 활성화를 해주면 된다. 그 비번은 링크를 클릭하면 자동으로 입력되게 해도 괜찮다. 이를 위해 , 이멜에 전송하는 방법이 필요하고, 데이터 베이스에 사용자가 인증을  했는지 하지 않았는지, 체크할 필요도 있다. 

- 또, 사용자의 기밀정보를 보관하는 것은 매우 부담스러운 일. 이런일을 구글이나 페이스북과 같은 기업에 위임하고, 우리서비스는 사용자의 식별자만을 유지하는 전략도 최근에 많이 사용됨. 구글, 페이스북 로그인, (*Federated Identity Management) 타사인증이라 부름
, 이런 주제에 관심을 가져보세요. 다중 사용자가 되면 시스템의 복잡도가 기하급수적으로 높아진다. 다중사용자가 능사는 아님, 그 대가가 혹독하다.  다중사용자 도입전에 그 경제성을 꼼꼼하게 따져 보시는, 현명함이 필요합니다. 

- 다중사용자 시스템이 어떻게 동작하는지 감이 오시나요?  다중사용자 시스템을 통해, 여러분의 애플리케이션은 마치 개인이 사회가 되는 혁명적인 변화를 맞이하게 될것입니다. 

